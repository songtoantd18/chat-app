<!-- index.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat App</title>
</head>

<body>
    <h1>Chat App</h1>
    <div id="messages"></div>
    <p>Current count: <span id="count">0</span></p>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        // Lấy địa chỉ và thời gian của client
        let clientLocation = "";
        let clientTime = "";

        // Lấy địa chỉ của client sử dụng Geolocation API
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    clientLocation = `Lat: ${latitude.toFixed(2)}, Long: ${longitude.toFixed(2)}`;
                },
                (error) => {
                    console.error("Error getting location:", error);
                    clientLocation = "Location unavailable";
                }
            );
        } else {
            clientLocation = "Geolocation not supported";
        }

        // Lấy thời gian hiện tại của client
        const now = new Date();
        clientTime = now.toLocaleString();

        // Lắng nghe sự kiện "message" từ server và hiển thị thông báo trên giao diện
        socket.on("message", (message) => {
            const messageElement = document.createElement("div");
            messageElement.textContent = message;
            document.getElementById("messages").appendChild(messageElement);
        });

        // Khi client kết nối, gửi thông tin địa chỉ và thời gian đến server
        socket.on("connect", () => {
            socket.emit("join", { location: clientLocation, time: clientTime });
        });
    </script>
</body>

</html>